{% extends 'base.html' %}

{% block content %}
<h2>All Tasks</h2>

{% for task in tasks %}
<div class="task-card {% if task.status == 'Completed' %}completed{% endif %}">
    <h3>
        <a href="{% url 'task_detail' task.id %}">
            {{ task.title }}
            {% if task.status == 'Completed' %}âœ…{% endif %}
        </a>
    </h3>

    <p>{{ task.description|truncatewords:20 }}</p>
    <p><strong>Status:</strong> {{ task.status }} | <strong>Deadline:</strong> {{ task.deadline }}</p>
    <p><strong>Assigned to:</strong> {{ task.assigned_to }}</p>

    <div class="task-actions">
        {% if task.status != 'Completed' %}
        <form method="post" action="{% url 'mark_completed' task.id %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit">Mark as Complete</button>
        </form>
        {% endif %}

        <a href="{% url 'edit_task' task.id %}"><button>Edit</button></a>

        <form method="post" action="{% url 'delete_task' task.id %}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this task?');">
            {% csrf_token %}
            <button type="submit" class="delete-btn">Delete</button>
        </form>
    </div>
</div>
{% empty %}
    <p>No tasks available.</p>
{% endfor %}
{% endblock %}
